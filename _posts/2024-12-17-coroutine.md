---
layout: post
category: golang
---

> 有时真的不知道该怎么写,看上去什么都懂了,但是真要说还是很难说的明白,所以这里我想套用一下中学思政老师的答题公式: <br><br>
> 回答思政大题的时候只需要回答几个问题: <br>
> 1. 是什么 2. 为什么 3. 怎么样 4. 怎么办


## 什么是协程

协程是一种轻量级的线程,协程的调度是由用户控制的,而不是由操作系统内核控制的,是用户态的.
### 跟线程的区别

线程是内核态的,而协程是用户态的.

线程是内核态的,由操作系统内核管理并调度,每个线程都有自己的执行栈,且分配了一些系统资源,如内存(栈空间),cpu时间片等等,创建和销毁都相对来说比较昂贵.

协程是用户态的,所有的资源都由用户管理,协程所需的资源就少很多,创建和销毁都相对来说比较廉价.

在我的理解里,协程对于线程来说只是一个语言层的封装,就拿go来说,goroutine就是一个协程,但是其实根据GMP模型来说,协程最终还是运行在线程上,由runtime包的调度来协调协程在线程上的并发执行,比如说抢占式调度啥的,而线程则是在内核中通过内核的调度来控制线程的调度.

因为是运行在线程上,协程所需的资源就很少,且操作协程也相对廉价,对一些IO密集型的操作来说,协程对于线程来说更加高效,因为如果一个协程因为io阻塞了,runtime就会挂起他去寻找别的协程执行,又因为协程不像线程,操作开销小,所以相对来说协程更加高效.

## 为什么是协程

