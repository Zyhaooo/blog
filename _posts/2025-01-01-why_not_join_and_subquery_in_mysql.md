---
title: 为什么不推荐使用join和子查询
layout: post
---

在我上学的时候就经常考关系型数据库的联表和子查询,但是很奇怪的是,在实际工作的时候,反而不推荐或者根本就不让用联表或者子查询,这是为什么呢?

于是我bing了很多的为什么不推荐使用的原因,收集和总结了一些大多数大佬回答的原因:

## 性能问题

考虑到join和子查询的性能实在是过于差,如果是数据量小的情况其实还好,但是等到数据量大了起来,一个请求可能几秒就过去了,这是不被允许的.

为什么会性能差呢?这就涉及到了mysql的join实现和子查询实现了.这些以后再讨论.但是据我了解,mysql pro 也就是oracle其实是没有这样的问题的,所以产品差异就体现在这里了:)

但是有一个很简单的解释就是多表查询其实是笛卡尔乘积的方式,当数据量上去了,整个检索的数据是成几何倍数增长的,这对于数据库来说是一个不小的压力.

还有就是索引问题,会导致索引难设计.但理论上来说,只要能用到相同的索引,效率是差不多的.(? 对索引的理解不深)

在现在的网络程序中,实际业务响应速度很快,所以实际整个系统的瓶颈在数据库和网络上,所以要尽量不要在数据库做业务需求,尽量解耦,减少数据库压力

### mysql的join和子查询实现

TODO

## 效率问题

抛开mysql的性能不谈,联表查询对于开发来说更加方便,因为只要写一个sql就可以查询出多个sql的数据,还可以分页,很方便.

但是在实际开发中,业务是会变动的,当业务变动,表结构开始改变的时候,那这个sql就等于要推到重建了.而且业务变动也不是偶发的,一般来说都是经常变动的.

联表查询也对缓存机制不太友好,一旦结构变动也要改变缓存的结构,等于又要重写.

分库分表时的执行效果不佳.

## 总结

在实际业务中还是尽量要少使用联表查询和子查询,以减轻数据库压力和解耦业务需求.但是凡事不是绝对,抛开剂量谈毒性就是耍流氓,如果你的数据量不大或者对反应时间又不敏感,那早点下班的操作何乐而不为呢?

> https://www.zhihu.com/question/485146470 
> https://www.muzhuangnet.com/show/682.html